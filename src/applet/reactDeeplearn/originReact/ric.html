<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<script>
function sleep(timeout) {
    let startTime = Date.now();
    while (Date.now()-startTime <timeout){

    }
}
const works = [
    ()=>{
        console.log('A1执行');
        sleep(10);
        console.log('A1结束');
    },
    ()=>{
        console.log('B1执行');
        sleep(15);
        console.log('B1结束');
    },
    ()=>{
        console.log('C1执行');
        sleep(20);
        console.log('C1结束');
    },
    ()=>{
        console.log('B2执行');
        sleep(20);
        console.log('B2结束');
    },
];

function ExcuteWork(deadline) {
    while (deadline.timeRemaining() > 0 && works.length > 0)  {
        console.log('剩余时间'+deadline.timeRemaining()+'ms');
        works.shift()()
    }
    requestIdleCallback(ExcuteWork)
}
requestIdleCallback(ExcuteWork)
</script>

</body>
</html>
